# How parseva-math builds a Homogeneous Abstract Syntax Tree

## Visitor Interface Generation
First, we need to have a grammar, such as `Math.g4`, found in `src/main/resources/parsevamath/tools/grammar`
Next, we need to tell ANTLR that we want to have it generate a visitor in `pom.xml`:

```xml

  <groupId>org.antlr</groupId>
                <artifactId>antlr4-maven-plugin</artifactId>
                <version>4.9.1</version>
                <configuration>
                    <visitor>true</visitor>
                    <listener>false</listener>
                    <inputEncoding>UTF-8</inputEncoding>
                    <sourceDirectory>
                        src/main/resources/parsevamath/tools/grammar
                    </sourceDirectory>
                </configuration>
```

Then, we generate the visitor and parser:

```bash

 mvn antlr4:antlr4

```

In the case of parseva-math, ANTLR generates two listeners, found in 
target/generated-sources:

```bash
├── assets
├── config
├── docs
├── LICENSE
├── pom.xml
├── README.md
├── src
└── target
    ├── checkstyle-cachefile
    ├── checkstyle-checker.xml
    ├── checkstyle-result.xml
    ├── classes
    ├── generated-sources
    │   ├── annotations
    │   └── antlr4
    │       ├── MathBaseVisitor.java
    │       ├── ...
    │       └── MathVisitor.java
    ├── maven-status
    ...


```

We are really only interested in `MathBaseVisitor.java`.  This java file generated by
ANTLR is comprised of one method per grammar rule or label, and we can override these 
methods to build out our AST. 

An example of a method from MathBaseVisitor:

```java

	@Override
  public T visitNumberExpr(MathParser.NumberExprContext ctx) { return visitChildren(ctx); }


```

As you can see, unless this method is overridden, it will simply return the result of visiting the children of this rule/ label.

## Homogeneous Node
Now we need to create a homogeneous ast node.  In parseva-math, this is called [MathAstNode](https://github.com/nmancus1/parseva-math/blob/main/src/main/java/parsevamath/tools/MathAstNode.java).  A homogeneous abstract syntax tree is a syntax tree that is 
comprised of only one node type; we assign each node with a type, upon instantiation.

For example. the following expression:
```bash

2 + 2
```

Will create a homogeneous abstract syntax tree like this:

```bash

    '- OP_ADD -> +
       |- NUM -> 2
       '- NUM -> 2

```

We can see that this abstract syntax tree has three nodes:
1. An `OP_ADD` node, representing the addition operation token.
2. A "NUM" node, which is the left child of the `OP_ADD` token.
3. Another "NUM" node, which is the right child of the `OP_ADD` token.
